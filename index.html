<!DOCTYPE html>

<html lang="zh-TW">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>åŒ—æ­ä¹‹æ—…è¨ˆç•« - Nordic Planner V13 (å«ç·¨è¼¯åŠŸèƒ½)</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>

        /* 1. Nordic Minimalism + Stronger Snowy Theme Color Palette */

        :root {

            --nordic-bg-soft: #eef4f7; /* Soft light blue/gray for main background (Stronger Nordic winter sky) */

            --nordic-white: #ffffff; /* Pure White for card backgrounds (Snow) */

            --nordic-dark: #343a40; /* Dark text for readability */

            --nordic-muted: #adb5bd; /* Muted gray for secondary text/borders */

            --nordic-accent: #2c6e73; /* Stronger Muted Teal/Pine Green for primary highlight */

            --nordic-christmas: #a7333d; /* Deeper Christmas Red for contrast/alerts/expense */

        }

        

        /* 2. Custom Tailwind-like classes using CSS variables */

        .bg-nordic-soft { background-color: var(--nordic-bg-soft); }

        .bg-nordic-white { background-color: var(--nordic-white); }

        .text-nordic-dark { color: var(--nordic-dark); }

        .text-nordic-accent { color: var(--nordic-accent); }

        .border-nordic-muted { border-color: var(--nordic-muted); }

        .text-nordic-christmas { color: var(--nordic-christmas); }

        

        /* Stronger, clearer shadow for a "floating on snow" effect */

        .shadow-snowy { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06); } 

        .shadow-strong { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1); } 



        /* Mobile App Container */

        #app {

            max-width: 600px;

            margin: auto;

            min-height: 100vh;

            display: flex;

            flex-direction: column;

            background-color: var(--nordic-bg-soft); 

            position: relative;

        }



        /* Vue Transition Styles */

        .fade-enter-active, .fade-leave-active {

            transition: opacity 0.3s ease;

        }

        .fade-enter-from, .fade-leave-to {

            opacity: 0;

        }

        

        /* Itinerary Date Slider Scrollbar */

        .date-slider::-webkit-scrollbar {

            height: 4px;

        }

        .date-slider::-webkit-scrollbar-thumb {

            background: var(--nordic-muted); 

            border-radius: 2px;

        }



        /* Modal Backdrop */

        .modal-backdrop {

            position: fixed;

            top: 0;

            left: 0;

            width: 100%;

            height: 100%;

            background-color: rgba(0, 0, 0, 0.4);

            z-index: 50;

            display: flex;

            align-items: center;

            justify-content: center;

        }



        /* Save Button Color (Ensuring it has color as requested) */

        .btn-save {

            background-color: var(--nordic-accent);

        }

        .btn-save:hover {

            background-color: #24585c; /* A slightly darker teal for hover */

        }

    </style>

</head>

<body class="bg-gray-100">



<div id="app">

    <header class="sticky top-0 bg-nordic-soft p-4 flex items-center justify-center z-20">

        <h1 class="text-xl font-extrabold text-nordic-accent">

            {{ headerTitle }}

        </h1>

    </header>



    <main class="flex-grow overflow-y-auto bg-nordic-soft relative">

        <transition name="fade" mode="out-in">

            

            <div v-if="currentTab === 'itinerary'" key="itinerary" class="pb-4">

                

                <div class="sticky top-0 bg-nordic-soft p-2 mb-4 z-10">

                    <div class="date-slider flex overflow-x-scroll space-x-2 pb-2">

                        <button v-for="(day, index) in itinerary" :key="index"

                                @click="selectDay(day)"

                                class="flex-shrink-0 px-3 py-1 text-sm font-medium rounded-full transition-colors border"

                                :class="{

                                    // ä¿®æ­£é»ï¼šé¸ä¸­æ—¥æœŸçš„æ¨£å¼ (éåç™½ï¼Œé«˜å°æ¯”é‚Šæ¡†)

                                    'bg-white border-2 border-nordic-accent text-nordic-accent shadow-md font-bold': selectedDay === day, 

                                    'bg-white border-gray-300 text-nordic-dark hover:bg-gray-100': selectedDay !== day

                                }">

                            {{ day.date.substring(5) }} <span class="text-xs ml-1 opacity-70">({{ day.day_of_week.substring(0, 1) }})</span>

                        </button>

                    </div>

                </div>



                <div class="p-4" v-if="selectedDay">

                    <h2 class="text-2xl font-bold text-nordic-dark mb-4">

                        {{ getFlagEmoji(selectedDay.country_code) }} 

                        {{ selectedDay.date.substring(5) }} - 

                        {{ selectedDay.city_country_zh }}

                    </h2>



                    <div v-if="selectedDay.weather" class="mb-4 p-4 bg-nordic-white rounded-xl shadow-strong border-l-4 border-gray-300 flex items-center">

                        <svg class="w-7 h-7 text-gray-500 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>

                        <div class="text-sm">

                            <p class="font-bold text-nordic-dark">â„ï¸ é è¨ˆå¤©æ°£</p>

                            <p class="text-gray-500">ğŸŒ¡ï¸ {{ selectedDay.weather['æ°£æº«'] || 'N/A' }} / â˜€ï¸ {{ selectedDay.weather['æ—¥ç…§'] || 'N/A' }}</p>

                        </div>

                    </div>



                    <div v-if="selectedDay.aurora_forecast" class="mb-4 p-4 rounded-xl shadow-strong border-l-4 border-nordic-accent bg-nordic-white">

                        <div class="flex items-center">

                            <svg class="w-7 h-7 text-nordic-accent mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 100 4m-4 10a2 2 0 100-4m14 0a2 2 0 100-4m-4 4a2 2 0 100 4m-10 4h12a2 2 0 002-2v-2a2 2 0 00-2-2H9a2 2 0 00-2 2v2a2 2 0 002 2z"></path></svg>

                            <div class="text-sm">

                                <p class="font-bold text-nordic-dark">ğŸŒŒ æ¥µå…‰é å ± (å»ºè­°)</p>

                                <p class="text-gray-600">**KP æŒ‡æ•¸ï¼š**<span class="font-semibold text-nordic-accent">{{ selectedDay.aurora_forecast['kp_index'] }}</span></p>

                                <p class="text-gray-600">**æœ€ä½³æ™‚é–“ï¼š**{{ selectedDay.aurora_forecast['time_range'] }}</p>

                                <p v-if="selectedDay.aurora_forecast['notes']" class="text-xs text-nordic-accent mt-1">ğŸ’¡ {{ selectedDay.aurora_forecast['notes'] }}</p>

                            </div>

                        </div>

                    </div>

                    

                    <h3 class="text-xl font-bold text-nordic-dark mb-3 border-b border-gray-300 pb-2">ç•¶æ—¥å®‰æ’</h3>

                    <div v-for="(item, itemIndex) in selectedDay.events" :key="itemIndex" class="mb-3 bg-nordic-white rounded-xl shadow-strong p-4 border border-gray-200">

                        <div class="flex justify-between items-start">

                            <div class="flex-grow">

                                <p class="text-sm font-bold text-nordic-accent">{{ item.time.substring(0, 5) }}</p>

                                <p class="font-medium text-nordic-dark text-lg">{{ item.schedule }}</p>

                            </div>

                            <button @click="openModalForEdit('itinerary', item, itemIndex)" class="text-nordic-accent hover:text-teal-600 transition p-1">

                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>

                            </button>

                        </div>

                        

                        <a v-if="item.location" :href="getMapLink(item.location)" target="_blank" class="text-sm text-blue-500 hover:underline flex items-center mt-2 pt-2 border-t border-gray-200">

                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg>

                            {{ item.location }}

                        </a>

                    </div>

                    

                    <div class="mt-6 p-4 bg-nordic-white rounded-xl shadow-strong text-sm text-gray-500 border border-gray-200">

                        <p class="font-bold text-nordic-dark">ğŸ  ä½å®¿ï¼š{{ selectedDay.accommodation }}</p>

                    </div>

                </div>

            </div>



            <div v-else-if="currentTab === 'checklist'" key="checklist" class="p-4">

                <h2 class="text-2xl font-bold text-nordic-dark mb-4">è¡Œå‰è£å‚™æ¸…å–® ğŸ“‹</h2>

                <p class="text-sm text-gray-500 mb-4">é»æ“Šé …ç›®å¯æ¨™è¨˜ç‚ºå·²å®Œæˆ / é»æ“Šåˆ†é¡æ¨™é¡Œå¯å±•é–‹æ”¶åˆã€‚</p>

                <div v-for="(items, category) in checklist" :key="category" class="mb-3 bg-nordic-white rounded-xl shadow-strong overflow-hidden border border-gray-200">

                    <div @click="toggleChecklist(category)" class="p-4 flex justify-between items-center cursor-pointer bg-gray-50 hover:bg-gray-100">

                        <h3 class="text-xl font-bold text-nordic-accent">{{ category }}</h3>

                        <span class="text-sm text-gray-500">{{ getCheckedCount(category) }} / {{ items.length }}</span>

                    </div>

                    

                    <ul v-if="!collapsedChecklist[category]" class="p-4 pt-0 space-y-3">

                        <li v-for="(item, index) in items" :key="index" class="flex items-center text-nordic-dark pt-3 border-t border-gray-200 first:border-t-0">

                            <input type="checkbox" :id="category + index" v-model="item.checked" class="form-checkbox h-5 w-5 text-nordic-accent rounded-sm mr-3 border-gray-300 bg-white">

                            <label :for="category + index" class="text-base flex-grow cursor-pointer" :class="{ 'line-through text-gray-400': item.checked }">

                                {{ item.name }}

                                <span v-if="item.notes" class="text-xs text-gray-500"> ({{ item.notes }})</span>

                            </label>

                            <button @click.stop="openModalForEdit('checklist', item, index, category)" class="text-nordic-accent hover:text-teal-600 transition p-1">

                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>

                            </button>

                        </li>

                    </ul>

                </div>

            </div>



            <div v-else-if="currentTab === 'accounting'" key="accounting" class="p-4">

                <h2 class="text-2xl font-bold text-nordic-dark mb-4">è¨˜å¸³ä¸­å¿ƒ ğŸ’°</h2>

                <div class="bg-nordic-white rounded-xl shadow-strong p-4 mb-6 border border-gray-200">

                    <p class="text-lg font-bold text-nordic-dark">ç¸½æ”¯å‡ºï¼š<span class="text-nordic-christmas">NT$ {{ totalSpent.toLocaleString() }}</span></p>

                </div>

                

                <h3 class="text-xl font-bold text-nordic-dark mb-3 border-b border-gray-300 pb-2">æ”¯å‡ºç´€éŒ„</h3>

                <div v-if="accounting.length === 0" class="bg-gray-100 text-gray-500 p-4 rounded-xl shadow-snowy text-center border border-gray-200">

                    <p>ç›®å‰æ²’æœ‰æ”¯å‡ºç´€éŒ„ã€‚è«‹é»æ“Šå³ä¸‹è§’æŒ‰éˆ• **+ æ–°å¢æ”¯å‡º**ã€‚</p>

                </div>

                <div v-for="(transaction, index) in accounting" :key="index" class="bg-nordic-white rounded-xl shadow-strong p-4 mb-3 flex justify-between items-center border border-gray-200">

                    <div>

                        <p class="font-medium text-nordic-dark">{{ transaction.description }}</p>

                        <p class="text-sm text-gray-500">{{ transaction.date }} ({{ transaction.category }})</p>

                    </div>

                    <div class="flex items-center">

                        <p class="text-lg font-bold text-nordic-christmas mr-3">

                            - NT$ {{ transaction.amount.toLocaleString() }}

                        </p>

                        <button @click.stop="openModalForEdit('accounting', transaction, index)" class="text-nordic-accent hover:text-teal-600 transition p-1">

                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>

                        </button>

                    </div>

                </div>

            </div>



            <div v-else-if="currentTab === 'shopping'" key="shopping" class="p-4">

                <h2 class="text-2xl font-bold text-nordic-dark mb-4">è³¼ç‰©æ¸…å–® ğŸ</h2>

                <div v-if="shoppingList.length === 0" class="bg-gray-100 text-gray-500 p-4 rounded-xl shadow-snowy text-center mb-4 border border-gray-200">

                    <p>ç›®å‰æ²’æœ‰è³¼ç‰©æ¸…å–®é …ç›®ã€‚è«‹é»æ“Šå³ä¸‹è§’æŒ‰éˆ• **+ è³¼ç‰©é …ç›®**ã€‚</p>

                </div>

                <div v-for="(item, index) in shoppingList" :key="index" class="bg-nordic-white rounded-xl shadow-strong p-4 mb-3 flex items-center border border-gray-200">

                    <input type="checkbox" :id="'shop' + index" v-model="item.purchased" class="form-checkbox h-5 w-5 text-nordic-accent rounded-sm mr-3 border-gray-300 bg-white">

                    <label :for="'shop' + index" class="flex-grow text-nordic-dark" :class="{ 'line-through text-gray-400': item.purchased }">

                        <span class="font-medium text-lg">{{ item.name }}</span>

                        <span v-if="item.store" class="text-sm text-gray-500 block">({{ item.store }})</span>

                    </label>

                    <button @click.stop="openModalForEdit('shopping', item, index)" class="text-nordic-accent hover:text-teal-600 transition p-1">

                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>

                    </button>

                </div>

            </div>

            

            <div v-else-if="currentTab === 'info'" key="info" class="p-4">

                <h2 class="text-2xl font-bold text-nordic-dark mb-4">å¯¦ç”¨è³‡è¨Š ğŸ’¡</h2>

                <div class="space-y-4">

                    <div class="bg-nordic-white rounded-xl shadow-strong p-4 border border-gray-200">

                        <h3 class="text-xl font-bold text-nordic-dark mb-2">è³‡æ–™å„²å­˜èˆ‡ç·¨è¼¯èªªæ˜ (V13 æ›´æ–°)</h3>

                        <p class="text-sm text-nordic-accent mb-2 font-bold">

                            âœ… è¡Œç¨‹ã€è¨˜å¸³ã€æ¸…å–®åŠŸèƒ½å·²å…¨é¢å•Ÿç”¨ç·¨è¼¯ã€æ–°å¢ã€åˆªé™¤ï¼

                        </p>

                        <p class="text-sm text-gray-600">

                            æ‰€æœ‰æ•¸æ“šçš†å„²å­˜åœ¨æ‚¨çš„ç€è¦½å™¨æœ¬åœ°å„²å­˜ (Local Storage)ï¼Œé‡æ–°æ•´ç†é é¢æ•¸æ“šä¸æœƒéºå¤±ã€‚<br>

                            ï¼ˆ**ç¯„ä¾‹è³‡æ–™**å·²åœ¨é¦–æ¬¡è¼‰å…¥æ™‚è‡ªå‹•å„²å­˜ã€‚ï¼‰

                        </p>

                    </div>

                </div>

            </div>

            

        </transition>

    </main>

    

    <div class="fixed bottom-24 right-4 z-50">

        <div v-if="isAddMenuOpen" @click.away="isAddMenuOpen = false" class="mb-3 space-y-2">

            

            <button v-if="currentTab === 'shopping'" @click.prevent="openModalForAdd('shopping')" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-strong hover:bg-gray-100 transition border border-gray-300">

                + è³¼ç‰©é …ç›®

            </button>

            <button v-if="currentTab === 'accounting'" @click.prevent="openModalForAdd('accounting')" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-strong hover:bg-gray-100 transition border border-gray-300">

                + æ–°å¢æ”¯å‡º

            </button>

            <button v-if="currentTab === 'itinerary'" @click.prevent="openModalForAdd('itinerary')" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-strong hover:bg-gray-100 transition border border-gray-300">

                + æ–°å¢è¡Œç¨‹ (ä»Šæ—¥)

            </button>

            <button v-if="currentTab === 'checklist'" @click.prevent="openModalForAdd('checklist')" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-strong hover:bg-gray-100 transition border border-gray-300">

                + æ–°å¢æ¸…å–®é …ç›®

            </button>

        </div>

        

        <button v-if="['itinerary', 'accounting', 'shopping', 'checklist'].includes(currentTab)" 

                @click="isAddMenuOpen = !isAddMenuOpen" 

                class="bg-nordic-accent text-white w-16 h-16 rounded-full flex items-center justify-center shadow-strong hover:bg-teal-700 transition transform hover:rotate-90">

            <svg v-if="!isAddMenuOpen" class="w-9 h-9" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>

            <svg v-else class="w-9 h-9" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>

        </button>

    </div>



    <transition name="fade">

        <div v-if="isModalOpen" class="modal-backdrop" @click.self="closeModal">

            <div class="bg-nordic-white p-6 rounded-xl shadow-2xl w-11/12 max-w-md border border-gray-300 transform transition-all scale-100">

                <h3 class="text-xl font-bold text-nordic-dark mb-4 border-b pb-2">

                    {{ editingItemIndex === -1 ? `æ–°å¢${modalTypeLabel}` : `ç·¨è¼¯${modalTypeLabel}` }}

                </h3>

                

                <form @submit.prevent="saveModalItem">

                    

                    <div v-if="modalDataType === 'itinerary'" class="mb-4 space-y-4">

                        <div class="w-full">

                            <label for="itemTime" class="block text-sm font-medium text-gray-700 mb-1">æ™‚é–“ (HH:MM)</label>

                            <input type="text" id="itemTime" v-model="editingItem.time" required

                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                                   placeholder="ä¾‹å¦‚ï¼š14:30">

                        </div>

                        <div>

                            <label for="itemLocation" class="block text-sm font-medium text-gray-700 mb-1">åœ°é» / å‚™è¨» (Location)</label>

                            <input type="text" id="itemLocation" v-model="editingItem.location"

                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                                   placeholder="ä¾‹å¦‚ï¼šTivoli, è·¯ç¨‹ï¼š15min">

                        </div>

                    </div>



                    <div class="mb-4">

                        <label for="itemName" class="block text-sm font-medium text-gray-700 mb-1">

                            {{ modalDataType === 'accounting' ? 'æ”¯å‡ºæè¿°' : (modalDataType === 'itinerary' ? 'è¡Œç¨‹é …ç›®' : 'é …ç›®åç¨±') }}

                        </label>

                        <input type="text" id="itemName" v-model="editingItem.name" required

                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                               :placeholder="modalDataType === 'accounting' ? 'ä¾‹å¦‚ï¼šæ™šé¤ã€Tivolié–€ç¥¨' : (modalDataType === 'itinerary' ? 'ä¾‹å¦‚ï¼šè–èª•è€äººæ‘ã€ç‹—æ‹‰é›ªæ©‡' : 'ä¾‹å¦‚ï¼šä¿æš–æ‰‹å¥—ã€ç´€å¿µå“')">

                    </div>



                    

                    <div v-if="modalDataType === 'accounting'">

                        <div class="mb-4">

                            <label for="itemAmount" class="block text-sm font-medium text-gray-700 mb-1">é‡‘é¡ (NT$)</label>

                            <input type="number" id="itemAmount" v-model.number="editingItem.amount" required min="1"

                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                                   placeholder="ä¾‹å¦‚ï¼š500">

                        </div>

                        <div class="mb-4 flex space-x-4">

                            <div class="w-1/2">

                                <label for="itemDate" class="block text-sm font-medium text-gray-700 mb-1">æ—¥æœŸ (ä¾‹å¦‚ï¼š12/20)</label>

                                <input type="text" id="itemDate" v-model="editingItem.date"

                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                                       placeholder="ä¾‹å¦‚ï¼š12/20">

                            </div>

                            <div class="w-1/2">

                                <label for="itemCategory" class="block text-sm font-medium text-gray-700 mb-1">é¡åˆ¥</label>

                                <select id="itemCategory" v-model="editingItem.category"

                                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent bg-white">

                                    <option value="é¤é£²">é¤é£²</option>

                                    <option value="äº¤é€š">äº¤é€š</option>

                                    <option value="ä½å®¿">ä½å®¿</option>

                                    <option value="è³¼ç‰©">è³¼ç‰©</option>

                                    <option value="é–€ç¥¨/æ´»å‹•">é–€ç¥¨/æ´»å‹•</option>

                                    <option value="å…¶ä»–">å…¶ä»–</option>

                                </select>

                            </div>

                        </div>

                    </div>

                    

                    <div v-else-if="modalDataType === 'shopping'">

                        <div class="mb-4">

                            <label for="shopStore" class="block text-sm font-medium text-gray-700 mb-1">è³¼è²·åœ°é»/å‚™è¨» (é¸å¡«)</label>

                            <input type="text" id="shopStore" v-model="editingItem.store"

                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                                   placeholder="ä¾‹å¦‚ï¼šH&Mã€æ©Ÿå ´å…ç¨…åº—">

                        </div>

                        <div class="flex items-center mb-6">

                            <input type="checkbox" id="shopPurchased" v-model="editingItem.purchased" 

                                   class="form-checkbox h-5 w-5 text-nordic-accent rounded-sm mr-2 border-gray-300 bg-white">

                            <label for="shopPurchased" class="text-base text-gray-700">æ˜¯å¦å·²è³¼è²·ï¼Ÿ</label>

                        </div>

                    </div>



                    <div v-else-if="modalDataType === 'checklist'">

                        <div class="mb-4">

                            <label for="checklistCategory" class="block text-sm font-medium text-gray-700 mb-1">åˆ†é¡</label>

                            <select id="checklistCategory" v-model="editingItem.category" :required="editingItemIndex === -1"

                                    :disabled="editingItemIndex !== -1 && editingItem.category"

                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent bg-white">

                                <option v-for="cat in Object.keys(checklist)" :key="cat" :value="cat">{{ cat }}</option>

                            </select>

                            <p v-if="editingItemIndex !== -1" class="text-xs text-gray-500 mt-1">ç·¨è¼¯æ¨¡å¼ä¸‹ç„¡æ³•ä¿®æ”¹åˆ†é¡</p>

                        </div>

                        <div class="mb-4">

                            <label for="itemNotes" class="block text-sm font-medium text-gray-700 mb-1">å‚™è¨» (Notes)</label>

                            <input type="text" id="itemNotes" v-model="editingItem.notes"

                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-nordic-accent focus:border-nordic-accent"

                                   placeholder="ä¾‹å¦‚ï¼šéœ€è²·æ–°ã€æ•¸é‡*2">

                        </div>

                        <div class="flex items-center mb-6">

                            <input type="checkbox" id="checkChecked" v-model="editingItem.checked" 

                                   class="form-checkbox h-5 w-5 text-nordic-accent rounded-sm mr-2 border-gray-300 bg-white">

                            <label for="checkChecked" class="text-base text-gray-700">æ˜¯å¦å·²å‹¾é¸ï¼Ÿ</label>

                        </div>

                    </div>



                    <div class="flex justify-between items-center pt-4 border-t border-gray-200">

                        <button v-if="editingItemIndex !== -1" @click.prevent="deleteModalItem"

                                type="button" 

                                class="px-4 py-2 text-sm font-medium rounded-lg text-white" 

                                :style="{ backgroundColor: 'var(--nordic-christmas)' }">

                            åˆªé™¤

                        </button>

                        

                        <div class="flex space-x-3 ml-auto">

                            <button @click.prevent="closeModal" type="button" class="px-4 py-2 text-sm font-medium text-gray-600 rounded-lg border border-gray-300 hover:bg-gray-100 transition">

                                å–æ¶ˆ

                            </button>

                            <button type="submit" 

                                    class="px-4 py-2 text-sm font-medium rounded-lg text-white btn-save transition hover:bg-teal-700">

                                å„²å­˜

                            </button>

                        </div>

                    </div>

                </form>

            </div>

        </div>

    </transition>





    <nav class="sticky bottom-0 bg-nordic-soft p-2 z-20">

        <ul class="flex justify-around">

            <li v-for="tab in tabs" :key="tab.id" class="flex-1 text-center">

                <a href="#" @click.prevent="changeTab(tab.id)" 

                   :class="{'flex flex-col items-center p-2 rounded-lg transition-colors': true, 'text-nordic-accent bg-gray-100': currentTab === tab.id, 'text-gray-500 hover:text-nordic-dark': currentTab !== tab.id}">

                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" v-html="tab.icon"></svg>

                    <span class="text-xs mt-1 font-medium">{{ tab.name }}</span>

                </a>

            </li>

        </ul>

    </nav>

</div>



<script>

    // å¼•å…¥ Vue 3 æ ¸å¿ƒ API (ref å’Œ watch ç”¨ä¾†å¯¦ç¾è³‡æ–™æŒä¹…åŒ–)

    const { createApp, computed, ref, watch } = Vue;



    // ----------------------------------------------------

    // æ ¸å¿ƒè³‡æ–™åº« (æ•¸æ“šåˆå§‹åŒ–èˆ‡é è¨­å€¼)

    // ----------------------------------------------------



    // Google Maps å°èˆªé€£çµç”Ÿæˆå™¨

    const getMapLink = (query) => {

        return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;

    };

    

    // åœ‹æ—— Emoji æ˜ å°„è¡¨

    const countryFlagMap = {

        'TW': 'ğŸ‡¹ğŸ‡¼',

        'FI': 'ğŸ‡«ğŸ‡®',

        'NO': 'ğŸ‡³ğŸ‡´',

        'DK': 'ğŸ‡©ğŸ‡°',

        'SE': 'ğŸ‡¸ğŸ‡ª',

    };



    // é è¨­è¡Œç¨‹è³‡æ–™ (ä¿ç•™ç”¨æˆ¶åŸæœ‰æ•¸æ“š)

    const defaultItineraryData = [

        // 1. 2025/12/19 (Taiwan)

        {

            date: "2025/12/19", day_of_week: "äº”", city_country_zh: "è‡ºç£", country_code: "TW",

            weather: null, aurora_forecast: null,

            events: [

                { time: "19:00:00", schedule: "æ¿æ©‹è»Šç«™é›†åˆ(ç´„20:30å‰åˆ°æ¡ƒæ©Ÿä¸€èˆª)", location: "è·¯ç¨‹ï¼š90min" },

                { time: "23:00:00", schedule: "âœˆè¯èˆªCI073 TPE å°åŒ— 23:05 èµ·é£›", location: "è·¯ç¨‹ï¼š15h45m" },

            ],

            accommodation: "é£›æ©Ÿä¸Š"

        },

        // 2. 2025/12/20 (Helsinki, Finland)

        {

            date: "2025/12/20", day_of_week: "å…­", city_country_zh: "èµ«çˆ¾è¾›åŸº", country_code: "FI",

            weather: { 'æ°£æº«': 'ç´„ -6Â°C åˆ° 0Â°C', 'æ—¥ç…§': 'ç´„ 6 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,

            events: [

                { time: "07:50:00", schedule: "âœˆ07:50æŠµé” AMSé˜¿å§†æ–¯ç‰¹ä¸¹", location: "è½‰æ©Ÿ" },

                { time: "11:20:00", schedule: "âœˆèŠ¬è˜­èˆªç©ºAY1302 AMSé˜¿å§†æ–¯ç‰¹ä¸¹ 11:20 èµ·é£›", location: "è·¯ç¨‹ï¼š2h25m" },

                { time: "14:45:00", schedule: "âœˆ14:45æŠµé” HELèµ«çˆ¾è¾›åŸº", location: "" },

                { time: "16:00:00", schedule: "ğŸ§³å‰å¾€ä½å®¿æ”¾è¡Œæ", location: "" },

                { time: "17:00:00", schedule: "ğŸ„Chrismas market", location: "å‚™è¨»ï¼šhttps://tuomaanmarkkinat.fi/en/" },

                { time: "17:00:00", schedule: "â™¨ï¸Sauna (2 hr)", location: "LÃ¶yly Helsinki" }, 

                { time: "19:00:00", schedule: "ğŸ¥£Sea horse resturant", location: "" },

                { time: "21:00:00", schedule: "Bar Kallio or center", location: "å‚™è¨»ï¼šBeer or cocktail? Karaoke or club?" },

            ],

            accommodation: "è€äººå®¶"

        },

        // 3. 2025/12/21 (Helsinki, Finland)

        {

            date: "2025/12/21", day_of_week: "æ—¥", city_country_zh: "èµ«çˆ¾è¾›åŸº", country_code: "FI",

            weather: { 'æ°£æº«': 'ç´„ -15Â°C åˆ° -7Â°C', 'æ—¥ç…§': 'æ¥µå¤œå¾®å…‰', 'å‚™è¨»': 'æ¥µåœ°å¯’å†·ï¼Œéœ€æ³¨æ„ä¿æš–' }, aurora_forecast: null,

            events: [

                { time: "10:00:00", schedule: "â˜•ï¸Cafe Regatta (è‚‰æ¡‚å°å±‹)", location: "æµ·é‚Š" },

                { time: "11:00:00", schedule: "Temppeliaukio Church (å²©çŸ³æ•™å ‚)", location: "" },

                { time: "11:00:00", schedule: "ğŸ“šOodi (åœ–æ›¸é¤¨)", location: "" },

                { time: "12:00:00", schedule: "ğŸ›ï¸Moomin Shop", location: "" },

                { time: "12:00:00", schedule: "Helsinki Cathedral", location: "å‚™è¨»ï¼šhttps://helsingintuomiokirkko.fi/en/index/uusipaataso.html" },

                { time: "13:00:00", schedule: "ğŸ¥£Lunch", location: "" },

                { time: "14:00:00", schedule: "Marimekko Outlet Herttoniemi", location: "" },

                { time: "17:00:00", schedule: "coffee or rest", location: "å‚™è¨»ï¼šback to put stuff and take swimming suit" },

                { time: "22:00:00", schedule: "Heading to train station", location: "" },

                { time: "23:13:00", schedule: "ğŸš‚23:13 å‰å¾€ç¾…ç“¦æ¶…ç±³ (å¤œé‹ªç«è»Š)", location: "" },

            ],

            accommodation: "ç«è»Šä¸Š"

        },

        // 4. 2025/12/22 (Rovaniemi, Finland)

        {

            date: "2025/12/22", day_of_week: "ä¸€", city_country_zh: "ç¾…ç“¦æ¶…ç±³", country_code: "FI",

            weather: { 'æ°£æº«': 'ç´„ -15Â°C åˆ° -7Â°C', 'æ—¥ç…§': 'æ¥µå¤œå¾®å…‰', 'é™æ°´': 'ç©©å®šç©é›ª' },

            aurora_forecast: { 'kp_index': 'Kp 3 (ä¸­ç­‰)', 'time_range': '22:00 - 02:00', 'notes': 'æ¥µå…‰ç†±é–€é»ï¼šæ­ç´æ–¯å±± (Ounasvaara)' },

            events: [

                { time: "10:59:00", schedule: "ğŸš‚10:59æŠµé” ç¾…ç“¦æ¶…ç±³", location: "è·¯ç¨‹ï¼š

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—æ­æ¥µç°¡ä¹‹æ—…è¨ˆç•« - Nordic Planner V8</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        /* 1. Nordic Minimalism Color Palette (Light Mode åŸºèª¿) */
        :root {
            --nordic-light: #f8f9fa; /* Very Light Gray/Off-White for main background */
            --nordic-white: #ffffff; /* Pure White for card backgrounds */
            --nordic-dark: #343a40; /* Dark text for readability */
            --nordic-muted: #adb5bd; /* Muted gray for secondary text/borders */
            --nordic-accent: #3b7979; /* Muted Teal/Pine Green for highlights */
        }
        
        /* 2. Custom Tailwind-like classes using CSS variables */
        .bg-nordic-light { background-color: var(--nordic-light); }
        .bg-nordic-white { background-color: var(--nordic-white); }
        .text-nordic-dark { color: var(--nordic-dark); }
        .text-nordic-accent { color: var(--nordic-accent); }
        .border-nordic-muted { border-color: var(--nordic-muted); }
        .shadow-nordic { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.03); } /* Lighter, subtler shadow */

        /* Mobile App Container */
        #app {
            max-width: 600px;
            margin: auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: var(--nordic-light); /* Apply main light background */
            position: relative;
        }

        /* Vue Transition Styles */
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s ease;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        
        /* Itinerary Date Slider */
        .date-slider::-webkit-scrollbar {
            height: 4px;
        }
        .date-slider::-webkit-scrollbar-thumb {
            background: #ced4da; /* Light Gray for scrollbar */
            border-radius: 2px;
        }
    </style>
</head>
<body class="bg-gray-100">

<div id="app">
    <header class="sticky top-0 bg-nordic-white shadow-nordic p-4 flex items-center justify-center z-20 border-b border-gray-200">
        <h1 class="text-xl font-extrabold text-nordic-accent">
            {{ headerTitle }}
        </h1>
    </header>

    <main class="flex-grow overflow-y-auto bg-nordic-light relative">
        <transition name="fade" mode="out-in">
            
            <div v-if="currentTab === 'itinerary'" key="itinerary" class="pb-4">
                
                <div class="sticky top-0 bg-nordic-white shadow-nordic p-2 mb-4 z-10 border-b border-gray-200">
                    <div class="date-slider flex overflow-x-scroll space-x-2 pb-2">
                        <button v-for="(day, index) in itinerary" :key="index"
                                @click="selectDay(day)"
                                class="flex-shrink-0 px-3 py-1 text-sm font-medium rounded-full transition-colors border"
                                :class="{
                                    'bg-nordic-accent border-nordic-accent text-white shadow-md font-bold': selectedDay === day, 
                                    'bg-white border-gray-300 text-nordic-dark hover:bg-gray-100': selectedDay !== day
                                }">
                            {{ day.date.substring(5) }} <span class="text-xs ml-1 opacity-70">({{ day.day_of_week.substring(0, 1) }})</span>
                        </button>
                    </div>
                </div>

                <div class="p-4" v-if="selectedDay">
                    <h2 class="text-2xl font-bold text-nordic-dark mb-4">{{ selectedDay.date.substring(5) }} - {{ selectedDay.city_country }}</h2>

                    <div v-if="selectedDay.weather" class="mb-4 p-4 bg-nordic-white rounded-xl shadow-nordic border-l-4 border-gray-300 flex items-center">
                        <svg class="w-7 h-7 text-gray-500 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                        <div class="text-sm">
                            <p class="font-bold text-nordic-dark">â„ï¸ é è¨ˆå¤©æ°£</p>
                            <p class="text-gray-500">ğŸŒ¡ï¸ {{ selectedDay.weather['æ°£æº«'] || 'N/A' }} / â˜€ï¸ {{ selectedDay.weather['æ—¥ç…§'] || 'N/A' }}</p>
                        </div>
                    </div>

                    <div v-if="selectedDay.aurora_forecast" class="mb-4 p-4 rounded-xl shadow-nordic border-l-4 border-nordic-accent bg-nordic-white">
                        <div class="flex items-center">
                            <svg class="w-7 h-7 text-nordic-accent mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 100 4m-4 10a2 2 0 100-4m14 0a2 2 0 100-4m-4 4a2 2 0 100 4m-10 4h12a2 2 0 002-2v-2a2 2 0 00-2-2H9a2 2 0 00-2 2v2a2 2 0 002 2z"></path></svg>
                            <div class="text-sm">
                                <p class="font-bold text-nordic-dark">ğŸŒŒ æ¥µå…‰é å ± (å»ºè­°)</p>
                                <p class="text-gray-600">**KP æŒ‡æ•¸ï¼š**<span class="font-semibold text-nordic-accent">{{ selectedDay.aurora_forecast['kp_index'] }}</span></p>
                                <p class="text-gray-600">**æœ€ä½³æ™‚é–“ï¼š**{{ selectedDay.aurora_forecast['time_range'] }}</p>
                                <p v-if="selectedDay.aurora_forecast['notes']" class="text-xs text-nordic-accent mt-1">ğŸ’¡ {{ selectedDay.aurora_forecast['notes'] }}</p>
                            </div>
                        </div>
                    </div>
                    

                    <h3 class="text-xl font-bold text-nordic-dark mb-3 border-b border-gray-300 pb-2">ç•¶æ—¥å®‰æ’</h3>
                    <div v-for="(item, itemIndex) in selectedDay.events" :key="itemIndex" class="mb-3 bg-nordic-white rounded-xl shadow-nordic p-4 border border-gray-200">
                        <div class="flex justify-between items-start">
                            <div class="flex-grow">
                                <p class="text-sm font-bold text-nordic-accent">{{ item.time }}</p>
                                <p class="font-medium text-nordic-dark text-lg">{{ item.schedule }}</p>
                            </div>
                            <button @click="showFeatureAlert('ç·¨è¼¯è¡Œç¨‹')" class="text-gray-400 hover:text-nordic-accent transition p-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>
                            </button>
                        </div>
                        
                        <a v-if="item.location" :href="getMapLink(item.location)" target="_blank" class="text-sm text-blue-500 hover:underline flex items-center mt-2 pt-2 border-t border-gray-200">
                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg>
                            {{ item.location }} (Google åœ°åœ–å°èˆª)
                        </a>
                    </div>
                    
                    <div class="mt-6 p-4 bg-nordic-white rounded-xl shadow-nordic text-sm text-gray-500 border border-gray-200">
                        <p class="font-bold text-nordic-dark">ğŸ  ä½å®¿ï¼š{{ selectedDay.accommodation }}</p>
                    </div>
                </div>
            </div>

            <div v-else-if="currentTab === 'checklist'" key="checklist" class="p-4">
                <h2 class="text-2xl font-bold text-nordic-dark mb-4">è¡Œå‰è£å‚™æ¸…å–® ğŸ“‹</h2>
                <p class="text-sm text-gray-500 mb-4">é»æ“Šé …ç›®å¯æ¨™è¨˜ç‚ºå·²å®Œæˆ / é»æ“Šåˆ†é¡æ¨™é¡Œå¯å±•é–‹æ”¶åˆã€‚</p>
                <div v-for="(items, category) in checklist" :key="category" class="mb-3 bg-nordic-white rounded-xl shadow-nordic overflow-hidden border border-gray-200">
                    <div @click="toggleChecklist(category)" class="p-4 flex justify-between items-center cursor-pointer bg-gray-50 hover:bg-gray-100">
                        <h3 class="text-xl font-bold text-nordic-accent">{{ category }}</h3>
                        <span class="text-sm text-gray-500">{{ getCheckedCount(category) }} / {{ items.length }}</span>
                    </div>
                    
                    <ul v-if="!collapsedChecklist[category]" class="p-4 pt-0 space-y-3">
                        <li v-for="(item, index) in items" :key="index" class="flex items-center text-nordic-dark pt-3 border-t border-gray-200 first:border-t-0">
                            <input type="checkbox" :id="category + index" v-model="item.checked" class="form-checkbox h-5 w-5 text-nordic-accent rounded-sm mr-3 border-gray-300 bg-white">
                            <label :for="category + index" class="text-base flex-grow cursor-pointer" :class="{ 'line-through text-gray-400': item.checked }">
                                {{ item.name }}
                                <span v-if="item.notes" class="text-xs text-gray-500"> ({{ item.notes }})</span>
                            </label>
                            <button @click.stop="showFeatureAlert('ç·¨è¼¯æ¸…å–®é …ç›®')" class="text-gray-400 hover:text-nordic-accent transition p-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>

            <div v-else-if="currentTab === 'accounting'" key="accounting" class="p-4">
                <h2 class="text-2xl font-bold text-nordic-dark mb-4">è¨˜å¸³ä¸­å¿ƒ ğŸ’°</h2>
                <div class="bg-nordic-white rounded-xl shadow-nordic p-4 mb-6 border border-gray-200">
                    <p class="text-lg font-bold text-nordic-dark">ç¸½æ”¯å‡ºï¼š<span class="text-red-600">NT$ {{ totalSpent.toLocaleString() }}</span></p>
                </div>
                
                <h3 class="text-xl font-bold text-nordic-dark mb-3 border-b border-gray-300 pb-2">æ”¯å‡ºç´€éŒ„</h3>
                <div v-if="accounting.length === 0" class="bg-gray-100 text-gray-500 p-4 rounded-xl shadow-nordic text-center border border-gray-200">
                    <p>ç›®å‰æ²’æœ‰æ”¯å‡ºç´€éŒ„ã€‚è«‹é»æ“Šå³ä¸‹è§’æŒ‰éˆ• **+ æ–°å¢æ”¯å‡º**ã€‚</p>
                </div>
                <div v-for="(transaction, index) in accounting" :key="index" class="bg-nordic-white rounded-xl shadow-nordic p-4 mb-3 flex justify-between items-center border border-gray-200">
                    <div>
                        <p class="font-medium text-nordic-dark">{{ transaction.description }}</p>
                        <p class="text-sm text-gray-500">{{ transaction.date }} ({{ transaction.category }})</p>
                    </div>
                    <p class="text-lg font-bold text-red-600">
                        - NT$ {{ transaction.amount.toLocaleString() }}
                    </p>
                </div>
            </div>

            <div v-else-if="currentTab === 'shopping'" key="shopping" class="p-4">
                <h2 class="text-2xl font-bold text-nordic-dark mb-4">è³¼ç‰©æ¸…å–® ğŸ</h2>
                <div v-if="shoppingList.length === 0" class="bg-gray-100 text-gray-500 p-4 rounded-xl shadow-nordic text-center mb-4 border border-gray-200">
                    <p>ç›®å‰æ²’æœ‰è³¼ç‰©æ¸…å–®é …ç›®ã€‚è«‹é»æ“Šå³ä¸‹è§’æŒ‰éˆ• **+ è³¼ç‰©é …ç›®**ã€‚</p>
                </div>
                <div v-for="(item, index) in shoppingList" :key="index" class="bg-nordic-white rounded-xl shadow-nordic p-4 mb-3 flex items-center border border-gray-200">
                    <input type="checkbox" :id="'shop' + index" v-model="item.purchased" class="form-checkbox h-5 w-5 text-nordic-accent rounded-sm mr-3 border-gray-300 bg-white">
                    <label :for="'shop' + index" class="flex-grow text-nordic-dark" :class="{ 'line-through text-gray-400': item.purchased }">
                        <span class="font-medium text-lg">{{ item.name }}</span>
                        <span v-if="item.store" class="text-sm text-gray-500 block">({{ item.store }})</span>
                    </label>
                    <button @click.stop="showFeatureAlert('ç·¨è¼¯è³¼ç‰©é …ç›®')" class="text-gray-400 hover:text-nordic-accent transition p-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L15.232 5.232z"></path></svg>
                    </button>
                </div>
            </div>
            
            <div v-else-if="currentTab === 'info'" key="info" class="p-4">
                <h2 class="text-2xl font-bold text-nordic-dark mb-4">å¯¦ç”¨è³‡è¨Š ğŸ’¡</h2>
                <div class="space-y-4">
                    <div class="bg-nordic-white rounded-xl shadow-nordic p-4 border border-gray-200">
                        <h3 class="text-xl font-bold text-nordic-dark mb-2">è³‡æ–™å„²å­˜èªªæ˜ (Local Storage)</h3>
                        <p class="text-sm text-nordic-accent mb-2">
                            âœ… **æ•¸æ“šç¾å·²å„²å­˜åœ¨æ‚¨çš„ç€è¦½å™¨æœ¬åœ°å„²å­˜ (Local Storage) ä¸­ï¼**
                        </p>
                        <p class="text-sm text-gray-600">
                            æ‚¨ä¿®æ”¹æˆ–æ–°å¢çš„è³‡æ–™ï¼ˆå¦‚æ¸…å–®å‹¾é¸ç‹€æ…‹ã€æ–°å¢çš„æ”¯å‡ºç­‰ï¼‰åœ¨æ‚¨ä¸‹æ¬¡é–‹å•Ÿæ­¤ HTML æª”æ¡ˆæ™‚ï¼Œå°‡æœƒè‡ªå‹•è®€å–ï¼Œæ•¸æ“šä¸æœƒå› ç‚ºé—œé–‰ç€è¦½å™¨è€Œéºå¤±ã€‚
                        </p>
                        <p class="text-xs text-red-500 mt-2">
                            âš ï¸ **é™åˆ¶ï¼š** æ­¤æ•¸æ“šåƒ…å„²å­˜åœ¨æ‚¨**ç•¶å‰ä½¿ç”¨çš„ç€è¦½å™¨**ä¸­ï¼Œç„¡æ³•åœ¨ä¸åŒè£ç½®é–“åŒæ­¥ã€‚
                        </p>
                    </div>
                </div>
            </div>
            
        </transition>
    </main>
    
    <div class="fixed bottom-20 right-4 z-50">
        <div v-if="isAddMenuOpen" @click.away="isAddMenuOpen = false" class="mb-3 space-y-2">
            <button v-if="currentTab === 'itinerary'" @click.prevent="showFeatureAlert('æ–°å¢è¡Œç¨‹')" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-md hover:bg-gray-100 transition border border-gray-300">
                + æ–°å¢è¡Œç¨‹
            </button>
            <button v-if="currentTab === 'accounting'" @click.prevent="handleFakeAdd('accounting', { description: 'æ–°å¢æ”¯å‡ºæ¸¬è©¦', date: new Date().toLocaleDateString('zh-TW').slice(5), category: 'æ¸¬è©¦', amount: 500 })" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-md hover:bg-gray-100 transition border border-gray-300">
                + æ–°å¢æ”¯å‡º (æ¸¬è©¦)
            </button>
            <button v-if="currentTab === 'shopping'" @click.prevent="handleFakeAdd('shopping', { name: 'æ–°é …ç›®æ¸¬è©¦', store: 'ç„¡', purchased: false })" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-md hover:bg-gray-100 transition border border-gray-300">
                + è³¼ç‰©é …ç›® (æ¸¬è©¦)
            </button>
            <button v-if="currentTab === 'checklist'" @click.prevent="showFeatureAlert('æ–°å¢æ¸…å–®')" class="block w-40 p-3 bg-nordic-white text-nordic-dark text-sm font-medium rounded-lg shadow-md hover:bg-gray-100 transition border border-gray-300">
                + æ–°å¢æ¸…å–®é …ç›®
            </button>
        </div>
        
        <button v-if="['itinerary', 'accounting', 'shopping', 'checklist'].includes(currentTab)" 
                @click="isAddMenuOpen = !isAddMenuOpen" 
                class="bg-nordic-accent text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-teal-600 transition transform hover:rotate-90">
            <svg v-if="!isAddMenuOpen" class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
            <svg v-else class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
    </div>

    <nav class="sticky bottom-0 bg-nordic-white border-t border-gray-200 shadow-xl p-2 z-20">
        <ul class="flex justify-around">
            <li v-for="tab in tabs" :key="tab.id" class="flex-1 text-center">
                <a href="#" @click.prevent="changeTab(tab.id)" 
                   :class="{'flex flex-col items-center p-2 rounded-lg transition-colors': true, 'text-nordic-accent bg-gray-100': currentTab === tab.id, 'text-gray-500 hover:text-nordic-dark': currentTab !== tab.id}">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" v-html="tab.icon"></svg>
                    <span class="text-xs mt-1 font-medium">{{ tab.name }}</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

<script>
    // å¼•å…¥ Vue 3 æ ¸å¿ƒ API (ref å’Œ watch ç”¨ä¾†å¯¦ç¾è³‡æ–™æŒä¹…åŒ–)
    const { createApp, computed, ref, watch } = Vue;

    // ----------------------------------------------------
    // æ ¸å¿ƒè³‡æ–™åº« (æ•¸æ“šåˆå§‹åŒ–èˆ‡é è¨­å€¼)
    // ----------------------------------------------------

    // Google Maps å°èˆªé€£çµç”Ÿæˆå™¨ (åƒ…ç‚ºç¯„ä¾‹ï¼Œéœ€åœ¨å¾Œç«¯æ­£ç¢ºç·¨ç¢¼)
    const getMapLink = (query) => {
        return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
    };

    const defaultItineraryData = [
        // ä¿æŒåŸæœ¬çš„ 16 å¤©è¡Œç¨‹æ•¸æ“š...
        {
            date: "2025/12/19", day_of_week: "äº”", city_country: "è‡ºç£ (Taiwan)", country_code: "", weather: null, aurora_forecast: null,
            events: [{ time: "23:05", schedule: "âœˆè¯èˆªCI073 TPE å°åŒ— èµ·é£›", location: "æ¡ƒåœ’åœ‹éš›æ©Ÿå ´" }],
            accommodation: "é£›æ©Ÿä¸Š"
        },
        {
            date: "2025/12/20", day_of_week: "å…­", city_country: "èµ«çˆ¾è¾›åŸº (Helsinki, FI)", country_code: "FI",
            weather: { 'æ°£æº«': 'ç´„ -6Â°C åˆ° 0Â°C', 'æ—¥ç…§': 'ç´„ 6 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "14:45", schedule: "âœˆæŠµé” HELèµ«çˆ¾è¾›åŸº", location: "Helsinki Airport" },
                { time: "17:00", schedule: "ğŸ„è–èª•å¸‚é›†", location: "Tuomaan Markkinat" },
                { time: "19:00", schedule: "ğŸ¥£Sea horse resturant (æ™šé¤)", location: "Sea Horse Restaurant" },
            ],
            accommodation: "è€äººå®¶ (Airbnb/é£¯åº—)"
        },
        {
            date: "2025/12/21", day_of_week: "æ—¥", city_country: "èµ«çˆ¾è¾›åŸº / ç¾…ç“¦æ¶…ç±³", country_code: "FI",
            weather: { 'æ°£æº«': 'ç´„ -15Â°C åˆ° -7Â°C', 'æ—¥ç…§': 'æ¥µå¤œå¾®å…‰', 'å‚™è¨»': 'æ¥µåœ°å¯’å†·ï¼Œéœ€æ³¨æ„ä¿æš–' }, aurora_forecast: null,
            events: [
                { time: "10:00", schedule: "â˜•ï¸Cafe Regatta (è‚‰æ¡‚å°å±‹)", location: "Cafe Regatta" },
                { time: "11:00", schedule: "Temppeliaukio Church (å²©çŸ³æ•™å ‚)", location: "Temppeliaukio Church" },
                { time: "18:00", schedule: "â™¨ï¸LÃ¶yly Sauna", location: "LÃ¶yly Helsinki" },
                { time: "23:13", schedule: "ğŸš‚å‰å¾€ç¾…ç“¦æ¶…ç±³ (å¤œé‹ªç«è»Š)", location: "Helsinki Central Railway Station" },
            ],
            accommodation: "ç«è»Šä¸Š"
        },
        {
            date: "2025/12/22", day_of_week: "ä¸€", city_country: "ç¾…ç“¦æ¶…ç±³ (Rovaniemi, FI)", country_code: "FI",
            weather: { 'æ°£æº«': 'ç´„ -15Â°C åˆ° -7Â°C', 'æ—¥ç…§': 'æ¥µå¤œå¾®å…‰', 'é™æ°´': 'ç©©å®šç©é›ª' }, 
            aurora_forecast: { 'kp_index': 'Kp 3 (ä¸­ç­‰)', 'time_range': '22:00 - 02:00', 'notes': 'æ¥µå…‰ç†±é–€é»ï¼šæ­ç´æ–¯å±± (Ounasvaara)' }, 
            events: [
                { time: "10:59", schedule: "ğŸš‚æŠµé” ç¾…ç“¦æ¶…ç±³", location: "Rovaniemi Railway Station" },
                { time: "13:00", schedule: "ğŸ…ğŸ¼è–èª•è€äººæ‘", location: "Santa Claus Village" },
                { time: "14:00", schedule: "ğŸ¥£Santa's Salmon Place (é®­é­šé¤)", location: "Santa's Salmon Place" },
                { time: "17:00", schedule: "ğŸ«ğŸ›·é¦´é¹¿é›ªæ©‡ (è‡ªé¸æ´»å‹•)" },
                { time: "19:00", schedule: "æ¥µå…‰åœ˜é›†åˆ (è¿”å›æ°‘å®¿æº–å‚™)" },
            ],
            accommodation: "Villa Muru (KW)"
        },
        {
            date: "2025/12/23", day_of_week: "äºŒ", city_country: "ç¾…ç“¦æ¶…ç±³ / ç‰¹ç¾…å§†ç‘Ÿ (TromsÃ¸, NO)", country_code: "NO",
            weather: { 'æ°£æº«': 'ç´„ -5Â°C åˆ° 2Â°C', 'æ—¥ç…§': 'æ¥µå¤œï¼Œæœ‰æ•¸å°æ™‚è—è‰²æ›™å…‰', 'å‚™è¨»': 'ç‰¹ç¾…å§†ç‘Ÿé æµ·è¼ƒç¾…ç“¦æ¶…ç±³æš–å’Œ' },
            aurora_forecast: { 'kp_index': 'Kp 4 (è‰¯å¥½)', 'time_range': '20:30 - 01:00', 'notes': 'ç§»å‹•æ—¥ï¼Œå»ºè­°åœ¨ç‰¹ç¾…å§†ç‘Ÿå¸‚å€æˆ–ä½å®¿é»å˜—è©¦' }, 
            events: [
                { time: "08:30", schedule: "ğŸ›·ç‹—æ‹‰é›ªæ©‡ (Get Your Guide)", location: "Rovaniemi Area" },
                { time: "11:55", schedule: "âœˆé£›å¾€ TOSç‰¹ç¾…å§†ç‘Ÿ", location: "Rovaniemi Airport" },
                { time: "16:00", schedule: "Check-in ä½å®¿", location: "TromsÃ¸ Airbnb" },
                { time: "17:00", schedule: "ğŸ›ï¸KIWI è¶…å¸‚æ¡è²·æ™šé¤èˆ‡éš”æ—¥æ—©é¤", location: "KIWI Supermarket TromsÃ¸" },
            ],
            accommodation: "TromsÃ¸ Airbnb(KW)"
        },
        {
            date: "2025/12/24", day_of_week: "ä¸‰", city_country: "ç‰¹ç¾…å§†ç‘Ÿ (TromsÃ¸, Norway)", country_code: "NO",
            weather: { 'æ°£æº«': 'ç´„ -5Â°C åˆ° 2Â°C', 'æ—¥ç…§': 'æ¥µå¤œè—è‰²æ›™å…‰', 'å‚™è¨»': 'è–èª•å¤œï¼Œå¤šæ•¸å•†å®¶æœƒææ—©é—œé–€' },
            aurora_forecast: { 'kp_index': 'Kp 3-4 (ä¸­ç­‰)', 'time_range': '21:00 - 03:00', 'notes': 'å¯æ­ä¹˜çºœè»Šä¸Šå±±ï¼Œé¿é–‹å…‰å®³æ›´ä½³' }, 
            events: [
                { time: "10:00", schedule: "ğŸ¥£æ—©åˆé¤ Koseverden&KoseligCafe", location: "Koseverden" },
                { time: "12:00", schedule: "ğŸš Fjellheisen çºœè»Š", location: "Fjellheisen" },
                { time: "13:00", schedule: "ğŸ¥£æœ€åŒ—éº¥ç•¶å‹", location: "McDonald's TromsÃ¸" },
                { time: "18:00", schedule: "â˜€ æ¥µå…‰åœ˜" },
            ],
            accommodation: "TromsÃ¸ Airbnb(KW)"
        },
        {
            date: "2025/12/25", day_of_week: "å››", city_country: "ç‰¹ç¾…å§†ç‘Ÿ (TromsÃ¸, Norway)", country_code: "NO",
            weather: { 'æ°£æº«': 'ç´„ -5Â°C åˆ° 2Â°C', 'æ—¥ç…§': 'æ¥µå¤œè—è‰²æ›™å…‰', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' },
            aurora_forecast: { 'kp_index': 'Kp 5 (é«˜)', 'time_range': '20:00 - 00:00', 'notes': 'æ¥µå…‰çˆ†ç™¼æ½›åŠ›é«˜ï¼Œä¿æŒé—œæ³¨ï¼' }, 
            events: [
                { time: "10:00", schedule: "ğŸ‘Ÿå¸‚å€ City Walk (åŒ—æ¥µä¹‹é–€ã€æ¸¯å£)" },
                { time: "16:00", schedule: "â›ªï¸åŒ—æ¥µå¤§æ•™å ‚ (Tromsdalen Church)", location: "Ishavskatedralen" },
                { time: "17:00", schedule: "ğŸ‘Ÿé€›å¸‚å€ (åœ–æ›¸é¤¨ã€ç†±ç‹—å ¡åº—)", location: "TromsÃ¸ bibliotek og byarkiv" },
                { time: "19:00", schedule: "â˜€ æ¥µå…‰åœ˜" },
            ],
            accommodation: "TromsÃ¸ Airbnb(KW)"
        },
        {
            date: "2025/12/26", day_of_week: "äº”", city_country: "ç‰¹ç¾…å§†ç‘Ÿ / å“¥æœ¬å“ˆæ ¹ (Copenhagen, DK)", country_code: "DK",
            weather: { 'æ°£æº«': 'ç´„ -1Â°C åˆ° 4Â°C', 'æ—¥ç…§': 'ç´„ 7.5 å°æ™‚', 'é™æ°´': 'è¼ƒå¸¸å‡ºç¾é›¨æ°´æˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "14:40", schedule: "âœˆæŠµé” CPH å“¥æœ¬å“ˆæ ¹", location: "Copenhagen Airport" },
                { time: "16:00", schedule: "ğŸ§³Check-in ä½å®¿", location: "LÃ¸vstrÃ¦de 5 (åœ°å€åƒè€ƒ)" },
                { time: "18:00", schedule: "ğŸ‘·The LEGOÂ® Store Tivoli Gardens", location: "The LEGOÂ® Store Tivoli Gardens" },
                { time: "21:00", schedule: "ğŸŒ·Tivoli èŠ±åœ’ (å·²è¨‚)", location: "Tivoli Gardens" },
                { time: "23:00", schedule: "ğŸ†Tivoli è–èª•ç…™ç«" },
            ],
            accommodation: "Sander Leaves-Pleasant 4(Kyle)"
        },
        {
            date: "2025/12/27", day_of_week: "å…­", city_country: "å“¥æœ¬å“ˆæ ¹ (Copenhagen, DK)", country_code: "DK",
            weather: { 'æ°£æº«': 'ç´„ -1Â°C åˆ° 4Â°C', 'æ—¥ç…§': 'ç´„ 7.5 å°æ™‚', 'é™æ°´': 'è¼ƒå¸¸å‡ºç¾é›¨æ°´æˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "09:00", schedule: "ğŸ‘ŸNyhavn (æ–°æ¸¯)", location: "Nyhavn" },
                { time: "12:00", schedule: "â›ªï¸Frederiks Kirke (å¤§ç†çŸ³æ•™å ‚)", location: "Frederiks Kirke" },
                { time: "13:00", schedule: "ğŸ’‚ğŸ¼Amalienborg (è¡›å…µäº¤æ¥)", location: "Amalienborg" },
                { time: "14:00", schedule: "ğŸ”Gasoline Grill (åˆé¤)", location: "Gasoline Grill" },
                { time: "17:00", schedule: "ğŸ§œğŸ»â€â™€ï¸Den Lille Havfrue (å°ç¾äººé­š)", location: "The Little Mermaid" },
                { time: "21:00", schedule: "ğŸ¸Ruby Bar (é…’å§)", location: "Ruby (Cocktail Bar)" },
            ],
            accommodation: "Sander Leaves-Pleasant 4(Kyle)"
        },
        {
            date: "2025/12/28", day_of_week: "æ—¥", city_country: "å“¥æœ¬å“ˆæ ¹ / æ–¯å¾·å“¥çˆ¾æ‘© (Stockholm, SE)", country_code: "SE",
            weather: { 'æ°£æº«': 'ç´„ -4Â°C åˆ° 1Â°C', 'æ—¥ç…§': 'ç´„ 6 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "12:30", schedule: "ğŸš¤Goboat é‹æ²³èˆ¹ (è‡ªè¨‚æ™‚é–“)", location: "Goboat Copenhagen" },
                { time: "14:00", schedule: "ğŸ°Rosenborg Slot (ç«ç‘°å ¡)", location: "Rosenborg Slot" },
                { time: "15:00", schedule: "ğŸ°Christiansborg Slot (å¤–é¢æ‹ç…§)", location: "Christiansborg Slot" },
                { time: "16:00", schedule: "ğŸ›ï¸StrÃ¸get è‡ªç”±é€›è¡—", location: "StrÃ¸get" },
                { time: "22:00", schedule: "å‰å¾€ç«è»Šç«™æˆ–æ©Ÿå ´ï¼Œæ­ä¹˜å¤œé–“äº¤é€šå·¥å…·å‰å¾€æ–¯å¾·å“¥çˆ¾æ‘©" },
            ],
            accommodation: "å¤œé–“äº¤é€šå·¥å…· / é£›æ©Ÿä¸Š"
        },
        {
            date: "2025/12/29", day_of_week: "ä¸€", city_country: "æ–¯å¾·å“¥çˆ¾æ‘© (Stockholm, SE)", country_code: "SE",
            weather: { 'æ°£æº«': 'ç´„ -4Â°C åˆ° 1Â°C', 'æ—¥ç…§': 'ç´„ 6 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "æ—©ä¸Š", schedule: "ğŸ§³æŠµé”æ–¯å¾·å“¥çˆ¾æ‘©ï¼ŒCheck-in ä½å®¿" },
                { time: "ä¸‹åˆ", schedule: "è€åŸå€ (Gamla Stan) é€›é€›", location: "Gamla Stan" },
                { time: "21:45", schedule: "ğŸ§Šçµ•å°å†°å§ (å·²è¨‚)", location: "ICEBAR by ICEHOTEL Stockholm" },
            ],
            accommodation: "æ–¯å¾·å“¥çˆ¾æ‘©é£¯åº—/Airbnb"
        },
        {
            date: "2025/12/30", day_of_week: "äºŒ", city_country: "æ–¯å¾·å“¥çˆ¾æ‘©", country_code: "SE",
            weather: { 'æ°£æº«': 'ç´„ -4Â°C åˆ° 1Â°C', 'æ—¥ç…§': 'ç´„ 6 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "ä¸Šåˆ", schedule: "å‹•ç‰©åœ’å³¶ (DjurgÃ¥rden)" },
                { time: "ä¸‹åˆ", schedule: "ç“¦è–©æ²‰èˆ¹åšç‰©é¤¨ (Vasa Museum)", location: "Vasa Museum" },
            ],
            accommodation: "æ–¯å¾·å“¥çˆ¾æ‘©é£¯åº—/Airbnb"
        },
        {
            date: "2025/12/31", day_of_week: "ä¸‰", city_country: "æ–¯å¾·å“¥çˆ¾æ‘© (è·¨å¹´å¤œ)", country_code: "SE",
            weather: { 'æ°£æº«': 'ç´„ -4Â°C åˆ° 1Â°C', 'æ—¥ç…§': 'ç´„ 6 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "ä¸‹åˆ", schedule: "æ–‡é’å³¶ SÃ¶dermalm é–’é€›", location: "SÃ¶dermalm" },
                { time: "æ™šä¸Š", schedule: "ğŸ¥‚HernÃ¶ Gin Bar - Stockholm", location: "HernÃ¶ Gin Bar - Stockholm" },
                { time: "è·¨å¹´", schedule: "ğŸ†Skinnarviksberget è§€çœ‹è·¨å¹´ç…™ç«", location: "Skinnarviksberget" },
            ],
            accommodation: "æ–¯å¾·å“¥çˆ¾æ‘©é£¯åº—/Airbnb"
        },
        {
            date: "2026/01/01", day_of_week: "å››", city_country: "æ–¯å¾·å“¥çˆ¾æ‘©", country_code: "SE",
            weather: { 'æ°£æº«': 'ç´„ -5Â°C åˆ° 0Â°C', 'æ—¥ç…§': 'ç´„ 6.5 å°æ™‚', 'é™æ°´': 'å¸¸æœ‰é™é›ªæˆ–é›¨å¤¾é›ª' }, aurora_forecast: null,
            events: [
                { time: "å…¨å¤©", schedule: "è€åŸå€èˆ‡å¸‚ä¸­å¿ƒæ•£æ­¥ (æ–°å¹´å‡æœŸï¼Œå¤šæ•¸å•†åº—ä¼‘æ¯)" },
            ],
            accommodation: "æ–¯å¾·å“¥çˆ¾æ‘©é£¯åº—/Airbnb"
        },
        {
            date: "2026/01/02", day_of_week: "äº”", city_country: "æ–¯å¾·å“¥çˆ¾æ‘© / è½‰æ©Ÿ", country_code: "",
            weather: null, aurora_forecast: null,
            events: [
                { time: "æ—©ä¸Š", schedule: "é€€æˆ¿ï¼Œå‰å¾€æ©Ÿå ´" },
                { time: "ä¸‹åˆ", schedule: "âœˆé£›æ©Ÿèµ·é£› ( ARN )" },
            ],
            accommodation: "é£›æ©Ÿä¸Š"
        },
        {
            date: "2026/01/03", day_of_week: "å…­", city_country: "è‡ºç£ (Taiwan)", country_code: "",
            weather: null, aurora_forecast: null,
            events: [
                { time: "ä¸‹åˆ", schedule: "âœˆæŠµé” TPE å°åŒ—" },
                { time: "æ™šä¸Š", schedule: "å›å®¶ä¼‘æ¯" },
            ],
            accommodation: "æº«æš–çš„å®¶"
        },
    ];

    const defaultChecklistData = {
        'è¡£ç‰©é¡': [
            { name: 'å…§è¡£è¤²', notes: '', checked: false },
            { name: 'ä¿æš–è¡£ç‰© (ç™¼ç†±è¡£ã€è¤²è¥ª)', notes: 'æ¥µåœ°ä¿æš–å¿…å‚™', checked: false },
            { name: 'ä¸Šè¡£', notes: '', checked: false },
            { name: 'ä¸‹èº«è¡£ç‰©', notes: '', checked: false },
            { name: 'ç¡è¡£', notes: '', checked: false },
            { name: 'å¤–å¥— (é˜²é¢¨é˜²æ°´)', notes: '', checked: false },
            { name: 'è¥ªå­ (ç¾Šæ¯›/åšè¥ª)', notes: '', checked: false },
            { name: 'é‹å­', notes: '', checked: false },
            { name: 'æ³³è¡£', notes: 'Saunaç”¨', checked: false },
        ],
        'é…ä»¶èˆ‡é˜²å¯’': [
            { name: 'å¤ªé™½çœ¼é¡', notes: 'é›ªåœ°é˜²å…‰å®³', checked: false },
            { name: 'å¸½å­ã€åœå·¾ã€æ‰‹å¥—ã€è€³ç½©', notes: 'é˜²æ°´æ‰‹å¥—æ›´ä½³', checked: false },
            { name: 'åŒ…åŒ…', notes: '', checked: false },
            { name: 'é£¾å“', notes: '', checked: false },
            { name: 'é›ªå¤¾ (é˜²æ»‘é‡˜)', notes: 'å»ºè­°å‚™ç”¨', checked: false },
            { name: 'æš–æš–åŒ…', notes: 'å¤šæº–å‚™', checked: false },
        ],
        'å€‹äººç”¨å“': [
            { name: 'ç‰™åˆ·ç‰™è†', notes: '', checked: false },
            { name: 'ç›¥æ´—ç”¨å“', notes: 'æ´—é«®ç²¾ã€æ²æµ´ä¹³ç­‰', checked: false },
            { name: 'è‡‰éƒ¨æ´—å¸ç”¨å“', notes: 'å¸å¦ä¹³ã€æ´—é¢ä¹³', checked: false },
            { name: 'ä¿é¤Šå“', notes: 'è‡‰ã€èº«é«”ã€è­·å”‡è†ã€è­·æ‰‹éœœ (åŒ—æ­æ¥µåº¦ä¹¾ç‡¥)', checked: false },
            { name: 'åŒ–å¦å“ã€æ¢³å­/é¢è†œ', notes: '', checked: false },
            { name: 'éš±å½¢çœ¼é¡/è¿‘è¦–çœ¼é¡', notes: '', checked: false },
            { name: 'åˆ®é¬ç”¨å“', notes: '', checked: false },
            { name: 'å€‹äººè—¥å“', notes: 'æ„Ÿå†’è—¥ã€èƒƒè—¥ã€ä¿å¥é£Ÿå“ã€ç™¼æ³¡éŒ ã€æšˆè»Šè—¥ç­‰', checked: false },
            { name: 'å¹é¢¨æ©Ÿ', notes: 'éƒ¨åˆ†ä½å®¿ä¸æä¾›', checked: false },
            { name: 'è¡›ç”Ÿæ£‰/è­·å¢Š', notes: '', checked: false },
            { name: 'æŒ‡ç”²å‰ª', notes: '', checked: false },
        ],
        'é›»å­ç”¢å“èˆ‡æ–‡ä»¶': [
            { name: 'è­·ç…§ã€ä¿¡ç”¨å¡ã€æ—…å¹³éšªæ–‡ä»¶', notes: 'é‡è¦è­‰ä»¶', checked: false },
            { name: 'éŒ¢', notes: 'å‚™ç”¨ç¾é‡‘', checked: false },
            { name: 'è¬ç”¨æ’é ­ã€å……é›»å™¨', notes: '', checked: false },
            { name: 'è¡Œå‹•é›»æº', notes: 'éœ€æ‰‹æä¸Šæ©Ÿ', checked: false },
            { name: 'ç¶²å¡/eSIM', notes: '', checked: false },
            { name: 'ç›¸æ©Ÿã€ä¸‰è…³æ¶', notes: 'æ¥µå…‰æ”å½±ç”¨', checked: false },
            { name: 'å…©å‹ç…§ç‰‡*2', notes: '', checked: false },
        ]
    };
    
    // æ¸…ç©ºè¨˜å¸³èˆ‡è³¼ç‰©æ¸…å–®
    const defaultAccounting = [];
    const defaultShoppingList = [];

    // Local Storage éµåè¨­å®š
    const STORAGE_KEYS = {
        ITINERARY: 'aurora_itinerary',
        CHECKLIST: 'aurora_checklist',
        ACCOUNTING: 'aurora_accounting',
        SHOPPING: 'aurora_shopping',
    };
    
    // ----------------------------------------------------
    // VUE APP å¯¦ä¾‹ (å·²æ•´åˆ Local Storage é‚è¼¯)
    // ----------------------------------------------------
    createApp({
        setup() {
            // --- Local Storage Helper Functions ---
            const loadFromLocalStorage = (key, defaultData) => {
                try {
                    const stored = localStorage.getItem(key);
                    return stored ? JSON.parse(stored) : defaultData;
                } catch (e) {
                    console.error(`Error loading ${key} from localStorage, using default data.`, e);
                    return defaultData;
                }
            };

            const saveToLocalStorage = (key, data) => {
                try {
                    // ä½¿ç”¨ JSON.stringify å°‡ JS ç‰©ä»¶è½‰æ›ç‚ºå­—ä¸²
                    localStorage.setItem(key, JSON.stringify(data));
                } catch (e) {
                    console.error(`Error saving ${key} to localStorage:`, e);
                }
            };
            
            // --- è¼‰å…¥æ•¸æ“šï¼šå…ˆå˜—è©¦å¾ Local Storage è®€å–ï¼Œå¤±æ•—å‰‡ä½¿ç”¨é è¨­å€¼ ---
            
            // è®“æ ¸å¿ƒæ•¸æ“šéƒ½æˆç‚ºéŸ¿æ‡‰å¼ ref è®Šé‡
            const itinerary = ref(loadFromLocalStorage(STORAGE_KEYS.ITINERARY, defaultItineraryData));
            const checklist = ref(loadFromLocalStorage(STORAGE_KEYS.CHECKLIST, defaultChecklistData));
            const accounting = ref(loadFromLocalStorage(STORAGE_KEYS.ACCOUNTING, defaultAccounting));
            const shoppingList = ref(loadFromLocalStorage(STORAGE_KEYS.SHOPPING, defaultShoppingList));

            // å…¶ä»–ç‹€æ…‹
            const currentTab = ref('itinerary');
            const selectedDay = ref(itinerary.value[0]); // ç¢ºä¿é¸å–ç¬¬ä¸€å¤©çš„è¡Œç¨‹
            const isAddMenuOpen = ref(false);
            const collapsedChecklist = ref({}); 

            const tabs = [
                { id: 'itinerary', name: 'è¡Œç¨‹è¡¨', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>' },
                { id: 'checklist', name: 'æ¸…å–®', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 002-2h2a2 2 0 002 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>' },
                { id: 'accounting', name: 'è¨˜å¸³', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m0 0l3 3m-3-3l-3 3M15 9h2a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2v-2"></path>' },
                { id: 'shopping', name: 'è³¼ç‰©', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>' },
                { id: 'info', name: 'è³‡è¨Š', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>' },
            ];

            // --- Watchers (è‡ªå‹•å„²å­˜æ©Ÿåˆ¶) ---
            // æ·±åº¦ç›£è½ (deep: true) ç¢ºä¿å³ä½¿ç‰©ä»¶å…§éƒ¨å±¬æ€§æ”¹è®Š (ä¾‹å¦‚æ¸…å–®é …ç›®è¢«å‹¾é¸)ï¼Œä¹Ÿæœƒè§¸ç™¼å„²å­˜
            watch(itinerary, (newVal) => {
                saveToLocalStorage(STORAGE_KEYS.ITINERARY, newVal);
            }, { deep: true });

            watch(checklist, (newVal) => {
                saveToLocalStorage(STORAGE_KEYS.CHECKLIST, newVal);
            }, { deep: true });

            watch(accounting, (newVal) => {
                saveToLocalStorage(STORAGE_KEYS.ACCOUNTING, newVal);
            }, { deep: true });

            watch(shoppingList, (newVal) => {
                saveToLocalStorage(STORAGE_KEYS.SHOPPING, newVal);
            }, { deep: true });
            
            // --- Computed properties ---
            const totalSpent = computed(() => {
                return accounting.value.reduce((sum, item) => sum + item.amount, 0);
            });

            const headerTitle = computed(() => {
                const tab = tabs.find(t => t.id === currentTab.value);
                return tab ? `â­ ${tab.name}` : 'Nordic Bliss Planner';
            });
            
            // --- Methods ---
            const selectDay = (day) => {
                selectedDay.value = day;
            };

            const toggleChecklist = (category) => {
                if (collapsedChecklist.value[category] === undefined) {
                    collapsedChecklist.value[category] = false; 
                }
                collapsedChecklist.value[category] = !collapsedChecklist.value[category];
            };

            const getCheckedCount = (category) => {
                const items = checklist.value[category];
                return items.filter(item => item.checked).length;
            };

            const changeTab = (tabId) => {
                currentTab.value = tabId;
                isAddMenuOpen.value = false;
            };

            // è™•ç†ã€Œæ–°å¢ã€æŒ‰éˆ•çš„æ¨¡æ“¬é»æ“Šï¼Œä¸¦çœŸæ­£æ–°å¢ä¸€å€‹æ¸¬è©¦æ•¸æ“šï¼Œä»¥é©—è­‰ Local Storage åŠŸèƒ½
            const handleFakeAdd = (type, data) => {
                if (type === 'accounting') {
                    // ç‚ºäº†æ¸¬è©¦æŒä¹…åŒ–ï¼Œé€™è£¡æ¨¡æ“¬å°‡æ•¸æ“šåŠ å…¥ accounting é™£åˆ—
                    accounting.value.push(data);
                    alert("âœ… å·²æ–°å¢ä¸€ç­†æ¸¬è©¦æ”¯å‡ºï¼è«‹é‡æ–°æ•´ç†é é¢ï¼Œæª¢æŸ¥æ•¸æ“šæ˜¯å¦è¢«å„²å­˜ã€‚");
                } else if (type === 'shopping') {
                    // ç‚ºäº†æ¸¬è©¦æŒä¹…åŒ–ï¼Œé€™è£¡æ¨¡æ“¬å°‡æ•¸æ“šåŠ å…¥ shoppingList é™£åˆ—
                    shoppingList.value.push(data);
                    alert("âœ… å·²æ–°å¢ä¸€ç­†æ¸¬è©¦è³¼ç‰©é …ç›®ï¼è«‹é‡æ–°æ•´ç†é é¢ï¼Œæª¢æŸ¥æ•¸æ“šæ˜¯å¦è¢«å„²å­˜ã€‚");
                } else {
                    showFeatureAlert('æ–°å¢åŠŸèƒ½');
                }
                isAddMenuOpen.value = false;
            };

            const showFeatureAlert = (feature) => {
                alert(`[${feature}åŠŸèƒ½]ï¼šæ­¤è™•å°‡å½ˆå‡ºè¡¨å–®è®“æ‚¨å¡«å¯«æ–°å¢/ç·¨è¼¯å…§å®¹ã€‚

è«‹æ³¨æ„ï¼šé›–ç„¶ä¸»è¦æ•¸æ“šå·²å¯å„²å­˜æ–¼ç€è¦½å™¨ï¼Œä½†æ–°å¢è¡¨å–®çš„ä»‹é¢ä»éœ€é€²ä¸€æ­¥é–‹ç™¼ã€‚æ‚¨å¯ä»¥åœ¨è¨˜å¸³/è³¼ç‰©é é¢é»æ“Šã€Œæ–°å¢æ”¯å‡º (æ¸¬è©¦)ã€/ã€Œæ–°å¢è³¼ç‰© (æ¸¬è©¦)ã€ä¾†é©—è­‰å„²å­˜åŠŸèƒ½ã€‚`);
                isAddMenuOpen.value = false;
            };

            return {
                currentTab,
                selectedDay,
                isAddMenuOpen,
                tabs,
                itinerary,
                checklist,
                accounting,
                shoppingList,
                collapsedChecklist,
                totalSpent,
                headerTitle,
                getMapLink,
                selectDay,
                changeTab,
                showFeatureAlert,
                handleFakeAdd, // æ–°å¢çš„æ¨¡æ“¬æ–°å¢åŠŸèƒ½
                toggleChecklist,
                getCheckedCount
            };
        }
    }).mount('#app');
</script>
</body>
</html>
